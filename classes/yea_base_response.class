class yea_base_response definition
  public
  final
  create public .

  public section.

    interfaces yea_response .

    methods constructor
      importing
        !sap_response type ref to if_http_response .
  protected section.
  private section.

    data _sap_response type ref to if_http_response .
    data _binary type xstring .
    data _text type string .
    data _done type abap_bool .

    methods check .
endclass.



class yea_base_response implementation.


* <SIGNATURE>---------------------------------------------------------------------------------------+
* | Instance Private Method YEA_BASE_RESPONSE->CHECK
* +-------------------------------------------------------------------------------------------------+
* +--------------------------------------------------------------------------------------</SIGNATURE>
  method check.
    if ( _done = abap_true ).
      data(no) = 1 / 0.
    endif.
  endmethod.


* <SIGNATURE>---------------------------------------------------------------------------------------+
* | Instance Public Method YEA_BASE_RESPONSE->CONSTRUCTOR
* +-------------------------------------------------------------------------------------------------+
* | [--->] SAP_RESPONSE                   TYPE REF TO IF_HTTP_RESPONSE
* +--------------------------------------------------------------------------------------</SIGNATURE>
  method constructor.
    _sap_response = sap_response.
  endmethod.


* <SIGNATURE>---------------------------------------------------------------------------------------+
* | Instance Public Method YEA_BASE_RESPONSE->YEA_RESPONSE~END
* +-------------------------------------------------------------------------------------------------+
* | [<-()] RETURNING                      TYPE REF TO YEA_RESPONSE
* +--------------------------------------------------------------------------------------</SIGNATURE>
  method yea_response~end.
    _done = abap_true.
    returning = me.
  endmethod.


* <SIGNATURE>---------------------------------------------------------------------------------------+
* | Instance Public Method YEA_BASE_RESPONSE->YEA_RESPONSE~FINISHED
* +-------------------------------------------------------------------------------------------------+
* | [<-()] RETURNING                      TYPE        ABAP_BOOL
* +--------------------------------------------------------------------------------------</SIGNATURE>
  method yea_response~finished.
    returning = _done.
  endmethod.


* <SIGNATURE>---------------------------------------------------------------------------------------+
* | Instance Public Method YEA_BASE_RESPONSE->YEA_RESPONSE~REDIRECT
* +-------------------------------------------------------------------------------------------------+
* | [--->] STATUS                         TYPE        I
* | [--->] ROUTE                          TYPE        STRING
* +--------------------------------------------------------------------------------------</SIGNATURE>
  method yea_response~redirect.
    check( ).
    _sap_response->redirect( url = route ).
  endmethod.


* <SIGNATURE>---------------------------------------------------------------------------------------+
* | Instance Public Method YEA_BASE_RESPONSE->YEA_RESPONSE~SEND_FILE
* +-------------------------------------------------------------------------------------------------+
* | [--->] BINARY                         TYPE        XSTRING
* | [<-()] RETURNING                      TYPE REF TO YEA_RESPONSE
* +--------------------------------------------------------------------------------------</SIGNATURE>
  method yea_response~send_file.
    check( ).
  endmethod.


* <SIGNATURE>---------------------------------------------------------------------------------------+
* | Instance Public Method YEA_BASE_RESPONSE->YEA_RESPONSE~SEND_JSON
* +-------------------------------------------------------------------------------------------------+
* | [--->] JSON                           TYPE        STRING
* | [<-()] RETURNING                      TYPE REF TO YEA_RESPONSE
* +--------------------------------------------------------------------------------------</SIGNATURE>
  method yea_response~send_json.
    check( ).
    _sap_response->set_header_field(
      name = 'Content-type'
      value = 'application/json' ).
    _sap_response->set_cdata( json ).
    returning = me.
    yea_response~end( ).
  endmethod.


* <SIGNATURE>---------------------------------------------------------------------------------------+
* | Instance Public Method YEA_BASE_RESPONSE->YEA_RESPONSE~SEND_TEXT
* +-------------------------------------------------------------------------------------------------+
* | [--->] TEXT                           TYPE        STRING
* | [<-()] RETURNING                      TYPE REF TO YEA_RESPONSE
* +--------------------------------------------------------------------------------------</SIGNATURE>
  method yea_response~send_text.
    check( ).
    _sap_response->set_header_field(
      name = 'Content-type'
      value = 'text/plain' ).
    _sap_response->set_cdata( text ).
    returning = me.
    yea_response~end( ).
  endmethod.


* <SIGNATURE>---------------------------------------------------------------------------------------+
* | Instance Public Method YEA_BASE_RESPONSE->YEA_RESPONSE~SET_STATUS
* +-------------------------------------------------------------------------------------------------+
* | [--->] STATUS                         TYPE        I
* | [<-()] RETURNING                      TYPE REF TO YEA_RESPONSE
* +--------------------------------------------------------------------------------------</SIGNATURE>
  method yea_response~set_status.
    check( ).
    message id 'YEA_HTTP' type 'I' number status into data(status_text).
    _sap_response->set_status( code = status reason = status_text ).
    returning = me.
  endmethod.
endclass.

